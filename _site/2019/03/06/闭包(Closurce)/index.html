<!DOCTYPE html>
<html>

  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>2019-03-06-闭包(Closurce) - 翻山越岭遇到一条狗的Blog</title>

	<link rel="shortcut icon" href="/styles/images/favicon.jpg">
	<link rel="icon" href="/styles/images/favicon.jpg">

	<link rel="stylesheet" href="/styles/css/index.css">
	<link rel="stylesheet" href="/styles/css/fontawesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="/styles/css/syntax.css">
	<link rel="canonical" href="/2019/03/06/%E9%97%AD%E5%8C%85(Closurce)/">
	<link rel="alternate" type="application/rss+xml" title="翻山越岭遇到一条狗的Blog" href="/feed.xml">
	
	<meta name="keywords" content="2019-03-06-闭包(Closurce), 翻山越岭遇到一条狗的Blog, 袁凯忻;个人博客;前端技术;">
	<meta name="description" content="袁凯忻;个人博客;前端技术;">

	<script src="/styles/js/jquery.min.js"></script>
	<!--[if lt IE 9]>
    	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  	<![endif]-->
  	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "//hm.baidu.com/hm.js?";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
  	<style type="text/css">
	  	.docs-content{
	  		margin-bottom: 10px;
	  	}
  	</style>
</head>

  <body class="index">

    <header class="navbar navbar-inverse navbar-fixed-top docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <!-- <a href="/" class="navbar-brand">
        <img src="/styles/images/logo.jpg">
      </a> -->
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        <li>
          <a href="/">Home</a>
        </li>
        <li>
          <a href="/categories/">Categories</a>
        </li>
        <li>
          <a href="/tag">Tag</a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <!-- <a><span id="busuanzi_container_site_pv" style="display:non">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></a> -->
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">关于<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a rel="nofollow" target="_blank" href="https://github.com/Kisnnnnn/">Github</a></li>
            <li><a rel="nofollow" target="_blank" href="https://kisnnnnn.github.io/kisnStudy/">关于作者</a></li>
            <li><a rel="nofollow" href="/books">我的书单</a></li>
            <li><a rel="nofollow" href="/reference">推荐博客</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</header>
    <div class="docs-header" id="content">
  <div class="container">
  	
  		<!--
		    <h1>2019-03-06-闭包(Closurce)</h1>
		    <p>Post on Mar 06, 2019 by <a href="/about">Kisn</a></p>
		-->
		    <h1>「今でもあなたはわたしの光」</h1>
    
  </div>
</div>
    
      
<div class="banner">
  <div class="container">
  	
    	<a href="/categories/#前端-ref">前端</a>	/
    	<a href="/tag/#笔记-ref">笔记</a>
    
  </div>
</div>

    

    <!-- <script src=""></script> -->
<div class="container docs-container">
  <div class="row">
    <div class="col-md-3">
      <div class="sidebar hidden-print" role="complementary">
        <div id="navigation">
    <h1>目录</h1>
    <ul class="nav sidenav">
    </ul>
    <!-- <div style="height: 200px;width: 200px;">
      <script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33" async="async"> 
      </script>
    </div> -->
  </div>
  
   
      </div>
    </div>
    <div class="col-md-9" role="main">
      <div class="panel docs-content">
        <div class="wrapper">
            <header class="post-header">
              <h1 class="post-title">2019-03-06-闭包(Closurce)</h1>
              <!--
                <p class="post-meta">Mar 6, 2019</p>
              -->
              <div class="meta">Posted on <span class="postdate">Mar 06, 2019</span> By <a target="_blank" href="http://localhost:4000">Kisn</a></div>
              <br />
            </header>
            <article class="post-content">
              <ul id="markdown-toc">
  <li><a href="#什么是闭包" id="markdown-toc-什么是闭包">什么是闭包？</a>    <ul>
      <li><a href="#变量的作用域" id="markdown-toc-变量的作用域">变量的作用域</a></li>
    </ul>
  </li>
  <li><a href="#如何从外部读取局部变脸" id="markdown-toc-如何从外部读取局部变脸">如何从外部读取局部变脸？</a>    <ul>
      <li><a href="#在函数内部在定义一个函数" id="markdown-toc-在函数内部在定义一个函数">在函数内部，在定义一个函数</a></li>
    </ul>
  </li>
  <li><a href="#闭包的用途" id="markdown-toc-闭包的用途">闭包的用途</a></li>
  <li><a href="#使用闭包的注意点" id="markdown-toc-使用闭包的注意点">使用闭包的注意点</a>    <ul>
      <li><a href="#好了写完了" id="markdown-toc-好了写完了">好了写完了</a></li>
      <li><a href="#好了写完了-1" id="markdown-toc-好了写完了-1">好了写完了</a></li>
      <li><a href="#好了写完了-2" id="markdown-toc-好了写完了-2">好了写完了</a></li>
      <li><a href="#好了写完了-3" id="markdown-toc-好了写完了-3">好了写完了</a></li>
      <li><a href="#好了写完了-4" id="markdown-toc-好了写完了-4">好了写完了</a></li>
      <li><a href="#好了写完了-5" id="markdown-toc-好了写完了-5">好了写完了</a></li>
      <li><a href="#好了写完了-6" id="markdown-toc-好了写完了-6">好了写完了</a></li>
      <li><a href="#好了写完了-7" id="markdown-toc-好了写完了-7">好了写完了</a></li>
      <li><a href="#好了写完了-8" id="markdown-toc-好了写完了-8">好了写完了</a></li>
      <li><a href="#好了写完了-9" id="markdown-toc-好了写完了-9">好了写完了</a></li>
      <li><a href="#好了写完了-10" id="markdown-toc-好了写完了-10">好了写完了</a></li>
      <li><a href="#好了写完了-11" id="markdown-toc-好了写完了-11">好了写完了</a></li>
      <li><a href="#好了写完了-12" id="markdown-toc-好了写完了-12">好了写完了</a></li>
      <li><a href="#好了写完了-13" id="markdown-toc-好了写完了-13">好了写完了</a></li>
      <li><a href="#好了写完了-14" id="markdown-toc-好了写完了-14">好了写完了</a></li>
      <li><a href="#好了写完了-15" id="markdown-toc-好了写完了-15">好了写完了</a></li>
      <li><a href="#好了写完了-16" id="markdown-toc-好了写完了-16">好了写完了</a></li>
      <li><a href="#好了写完了-17" id="markdown-toc-好了写完了-17">好了写完了</a></li>
      <li><a href="#好了写完了-18" id="markdown-toc-好了写完了-18">好了写完了</a></li>
      <li><a href="#好了写完了-19" id="markdown-toc-好了写完了-19">好了写完了</a></li>
      <li><a href="#好了写完了-20" id="markdown-toc-好了写完了-20">好了写完了</a></li>
      <li><a href="#好了写完了-21" id="markdown-toc-好了写完了-21">好了写完了</a></li>
      <li><a href="#好了写完了-22" id="markdown-toc-好了写完了-22">好了写完了</a></li>
      <li><a href="#好了写完了-23" id="markdown-toc-好了写完了-23">好了写完了</a></li>
      <li><a href="#好了写完了-24" id="markdown-toc-好了写完了-24">好了写完了</a></li>
      <li><a href="#好了写完了-25" id="markdown-toc-好了写完了-25">好了写完了</a></li>
      <li><a href="#好了写完了-26" id="markdown-toc-好了写完了-26">好了写完了</a></li>
      <li><a href="#好了写完了-27" id="markdown-toc-好了写完了-27">好了写完了</a></li>
      <li><a href="#好了写完了-28" id="markdown-toc-好了写完了-28">好了写完了</a></li>
      <li><a href="#好了写完了-29" id="markdown-toc-好了写完了-29">好了写完了</a></li>
      <li><a href="#好了写完了-30" id="markdown-toc-好了写完了-30">好了写完了</a></li>
      <li><a href="#好了写完了-31" id="markdown-toc-好了写完了-31">好了写完了</a></li>
      <li><a href="#好了写完了-32" id="markdown-toc-好了写完了-32">好了写完了</a></li>
      <li><a href="#好了写完了-33" id="markdown-toc-好了写完了-33">好了写完了</a></li>
      <li><a href="#好了写完了-34" id="markdown-toc-好了写完了-34">好了写完了</a></li>
      <li><a href="#好了写完了-35" id="markdown-toc-好了写完了-35">好了写完了</a></li>
      <li><a href="#好了写完了-36" id="markdown-toc-好了写完了-36">好了写完了</a></li>
      <li><a href="#好了写完了-37" id="markdown-toc-好了写完了-37">好了写完了</a></li>
      <li><a href="#好了写完了-38" id="markdown-toc-好了写完了-38">好了写完了</a></li>
      <li><a href="#好了写完了-39" id="markdown-toc-好了写完了-39">好了写完了</a></li>
      <li><a href="#好了写完了-40" id="markdown-toc-好了写完了-40">好了写完了</a></li>
      <li><a href="#好了写完了-41" id="markdown-toc-好了写完了-41">好了写完了</a></li>
    </ul>
  </li>
</ul>

<h2 id="什么是闭包">什么是闭包？</h2>
<p>闭包就是能够读取其他函数内部变脸的函数。在JavaScript中，只有函数内部的子函数才能读取局部变量，所以闭包可以理解成「定义在一个函数内部的函数」。本质，闭包是将函数内部和函数外部连接起来的桥梁。</p>

<h3 id="变量的作用域">变量的作用域</h3>

<p>要了解闭包，首先必须了解JavaScript特殊的变量作用域。</p>
<ul>
  <li>全局变量</li>
  <li>局部变量</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var a = 12345； // 全局变量

function f1(){
    alert(a);
}

f1(); //12345
</code></pre></div></div>

<p>但是在函数外部自然不能读取函数内部的变量。</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function f1(){
    var a = 12345;
}

alert(a); // error
</code></pre></div></div>
<blockquote>
  <p>在函数内部声明变量的时候，一定要使用var，如果不使用，实际上你生命了一个全局变量</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function f1(){
    a = 12345;
}
f1();
alert(n); // 12345
</code></pre></div></div>
<h2 id="如何从外部读取局部变脸">如何从外部读取局部变脸？</h2>
<h3 id="在函数内部在定义一个函数">在函数内部，在定义一个函数</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function f1(){
    var n = 999;
    function f2(){
        alert(n); // 999
    }
}
</code></pre></div></div>
<p>在代码中，函数f2就被包含在函数f1内部，这是f1内部的所有全局变量，对f2都是可见的。但是反过来不行，f2内部的局部变量，对f1是不可见的。只能子对象一级以及网上寻找所有父对象的变量。</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function f1(){
    var n=999;
    function f2(){
        alert(n);
    }
    
    return f2;
}

var res = f1();

res(); // 999
</code></pre></div></div>

<p>如上面的代码所示，f2函数就是闭包。</p>

<h2 id="闭包的用途">闭包的用途</h2>
<p>闭包主要的在</p>
<ul>
  <li>可以读取函数内部的变量</li>
  <li>让这些变脸的值始终保持在内存中</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function f1(){
    var n = 999;
    
    nAdd = function(){
        n += 1;
    }
    
    function f2(){
        alert(n);
    }
    
    return f2;
}

var res = f1();

res(); // 999

nAdd();

res(); // 1000
</code></pre></div></div>

<p>在上述代码中，res实际上就是闭包f2函数。他一共运行了2次，第一次的值是999，第二次的值是1000。这证明了，函数f1中的局部变量n一直保持在内存中，并没有在f1调用后被自动清除。</p>

<p>f1是f2的富含，而f2被赋予了一个全局变脸，这导致f2永远存在内存中，而f2的存在依赖于f1，因此f1也必须始终存在于内存中，不会在调用结束后，被垃圾回收机制回收。</p>

<p><strong>值得注意</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nAdd = function(){
    n += 1;
}
</code></pre></div></div>
<p>首先，在nAdd前面没有加<strong>var</strong>,因此nAdd是一个全局变量，而不是局部棉量，其次nAdd的值是一个匿名函数，而这个匿名函数本身也是个闭包，所以nAdd相当于是一个setter，可以在函数外部对内部的局部变量进行操作。</p>

<blockquote>
  <p>注意！ 「onAdd」这种函数写法，在严格模式（’use strict’）下是会报错的。</p>
</blockquote>

<h2 id="使用闭包的注意点">使用闭包的注意点</h2>

<ul>
  <li>由于闭包会使得函数的变量都被保存在内存中，内存消耗是很严重的，所以不能滥用闭包，否则会造成网页的性能问题，在IE中会导致内存泄漏。解决方法是，在退出函数前，将不使用的局部变量全部删除</li>
  <li>闭包会在函数外部，改变父函数的内部变量的值。所以，如果你把父函数当做对象使用，把闭包当做他的公用方法，把内部变量当做他的私有属性，必须注意，不能随便改变父函数内部变量的值。</li>
</ul>

<h4 id="好了写完了">好了写完了</h4>
<h4 id="好了写完了-1">好了写完了</h4>
<h4 id="好了写完了-2">好了写完了</h4>
<h4 id="好了写完了-3">好了写完了</h4>
<h4 id="好了写完了-4">好了写完了</h4>
<h4 id="好了写完了-5">好了写完了</h4>
<h4 id="好了写完了-6">好了写完了</h4>
<h4 id="好了写完了-7">好了写完了</h4>
<h4 id="好了写完了-8">好了写完了</h4>
<h4 id="好了写完了-9">好了写完了</h4>
<h4 id="好了写完了-10">好了写完了</h4>
<h4 id="好了写完了-11">好了写完了</h4>
<h4 id="好了写完了-12">好了写完了</h4>
<h4 id="好了写完了-13">好了写完了</h4>
<h4 id="好了写完了-14">好了写完了</h4>
<h4 id="好了写完了-15">好了写完了</h4>
<h4 id="好了写完了-16">好了写完了</h4>
<h4 id="好了写完了-17">好了写完了</h4>
<h4 id="好了写完了-18">好了写完了</h4>
<h4 id="好了写完了-19">好了写完了</h4>
<h4 id="好了写完了-20">好了写完了</h4>
<h4 id="好了写完了-21">好了写完了</h4>
<h4 id="好了写完了-22">好了写完了</h4>
<h4 id="好了写完了-23">好了写完了</h4>
<h4 id="好了写完了-24">好了写完了</h4>
<h4 id="好了写完了-25">好了写完了</h4>
<h4 id="好了写完了-26">好了写完了</h4>
<h4 id="好了写完了-27">好了写完了</h4>
<h4 id="好了写完了-28">好了写完了</h4>
<h4 id="好了写完了-29">好了写完了</h4>
<h4 id="好了写完了-30">好了写完了</h4>
<h4 id="好了写完了-31">好了写完了</h4>
<h4 id="好了写完了-32">好了写完了</h4>
<h4 id="好了写完了-33">好了写完了</h4>
<h4 id="好了写完了-34">好了写完了</h4>
<h4 id="好了写完了-35">好了写完了</h4>
<h4 id="好了写完了-36">好了写完了</h4>
<h4 id="好了写完了-37">好了写完了</h4>
<h4 id="好了写完了-38">好了写完了</h4>
<h4 id="好了写完了-39">好了写完了</h4>
<h4 id="好了写完了-40">好了写完了</h4>
<h4 id="好了写完了-41">好了写完了</h4>

<hr />
<p>再说点？</p>

<blockquote>
  <p>今天整理完，感觉还有一些时间，分享下上周看的奥斯卡最佳影片「绿皮书」</p>
</blockquote>

<p>特别喜欢这句对白</p>

<p><strong>「如果我不够黑人，也不够白人，又或不够男人，那请你告诉我，托尼，那我到底算是什么人！？」</strong></p>

<p>从学校踏入社会，也有快三年时间了，接触的人也越来越多。在我三观里，对于男女平权、种族仇恨等等，都比较模糊，我只是一直觉得人不可能存在在中立阶段，更多可能是偏左、右，不管从自然选择、和平演变，我觉得大多数人类更多站在自己的利益面发表自己的言论。</p>

<p>在我看来，这部电影给我最大的思考就就是Don Shirley在雨中对Tony的歇斯底里的怒吼，为什么人活着就要偏向人群所希望亦或一致认知的生活状态。乃至已经到了Don这种高度学历、地位、教育的人依旧困在自己的思想桎梏。</p>

<p>我经常告诉自己「可能你改不了世界的现状，也改不了身边的朋友、亲人的环境，至少在自己认知方面觉得可以坚持的事，认真坚持到底。」乃至可能也不够「黑」、不够「白」。</p>


            </article>
        </div>
      </div>
    </div>
  </div>
</div>

    
    <footer class="footer" role="contentinfo">
	<div class="container">
		<p class="copyright">Copyright &copy; 2014-2019 <a href="https://kisnnnnn.github.io/kisnStudy/"><code>Kisn</code></a>.</p>
		<!-- <p>Powered by <a href="http://jekyllrb.com">Jekyll</a>, themed from <a href="http://lesscss.cn/">Less</a>, refactored by <a href="http://www.hifreud.com/">Freud Kang</a></p> -->
	</div>
</footer>

<script src="/styles/js/jquery.min.js"></script>
<script src="/styles/js/bootstrap.min.js"></script>
<script src="/styles/js/holder.min.js"></script>
<script src="/styles/js/lessismore.js"></script>
<script src="/styles/js/application.js"></script>
<script src="/styles/js/jquery.zoom.min.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script>
	(function ($) {
		window.onload = function () {
			var imgELemList = $('.container img');

			imgELemList.on('click', function () {
				console.log(imgELemList);

				window.location.href = this.src;
			});
		}
	})(jQuery)
</script>

  </body>
</html>
