<!DOCTYPE html>
<html>

  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>2019-02-28-JS引擎解析过程-解释阶段 - 翻山越岭遇到一条狗的Blog</title>

	<link rel="shortcut icon" href="/styles/images/favicon.jpg">
	<link rel="icon" href="/styles/images/favicon.jpg">

	<link rel="stylesheet" href="/styles/css/index.css">
	<link rel="stylesheet" href="/styles/css/fontawesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="/styles/css/syntax.css">
	<link rel="canonical" href="/2019/02/28/JS%E5%BC%95%E6%93%8E%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B-%E8%A7%A3%E9%87%8A%E9%98%B6%E6%AE%B5/">
	<link rel="alternate" type="application/rss+xml" title="翻山越岭遇到一条狗的Blog" href="/feed.xml">
	
	<meta name="keywords" content="2019-02-28-JS引擎解析过程-解释阶段, 翻山越岭遇到一条狗的Blog, 袁凯忻;个人博客;前端技术;">
	<meta name="description" content="袁凯忻;个人博客;前端技术;">

	<script src="/styles/js/jquery.min.js"></script>
	<!--[if lt IE 9]>
    	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  	<![endif]-->
  	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "//hm.baidu.com/hm.js?";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
  	<style type="text/css">
	  	.docs-content{
	  		margin-bottom: 10px;
	  	}
  	</style>
</head>

  <body class="index">

    <header class="navbar navbar-inverse navbar-fixed-top docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <!-- <a href="/" class="navbar-brand">
        <img src="/styles/images/logo.jpg">
      </a> -->
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        <li>
          <a href="/">Home</a>
        </li>
        <li>
          <a href="/categories/">Categories</a>
        </li>
        <li>
          <a href="/tag">Tag</a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <!-- <a><span id="busuanzi_container_site_pv" style="display:non">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></a> -->
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">关于<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a rel="nofollow" target="_blank" href="https://github.com/Kisnnnnn/">Github</a></li>
            <li><a rel="nofollow" target="_blank" href="https://kisnnnnn.github.io/kisnStudy/">关于作者</a></li>
            <li><a rel="nofollow" href="/books">我的书单</a></li>
            <li><a rel="nofollow" href="/reference">推荐博客</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</header>
    <div class="docs-header" id="content">
  <div class="container">
  	
  		<!--
		    <h1>2019-02-28-JS引擎解析过程-解释阶段</h1>
		    <p>Post on Feb 28, 2019 by <a href="/about">Kisn</a></p>
		-->
		    <h1>「今でもあなたはわたしの光」</h1>
    
  </div>
</div>
    
      
<div class="banner">
  <div class="container">
  	
    	<a href="/categories/#前端-ref">前端</a>	/
    	<a href="/tag/#笔记-ref">笔记</a>
    
  </div>
</div>

    

    <!-- <script src=""></script> -->
<link rel="stylesheet" href="/styles/css/index.css">
<link rel="stylesheet" href="/styles/css/fontawesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/styles/css/syntax.css">
<div class="container docs-container">
  <div class="row">
    <div class="col-md-3">
      <div class="sidebar hidden-print" role="complementary">
        <div id="navigation">
    <h1>目录</h1>
    <ul class="nav sidenav">
    </ul>
    <!-- <div style="height: 200px;width: 200px;">
      <script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33" async="async"> 
      </script>
    </div> -->
  </div>
  
   
      </div>
    </div>
    <div class="col-md-9" role="main">
      <div class="panel docs-content">
        <div class="wrapper">
            <header class="post-header">
              <h1 class="post-title">2019-02-28-JS引擎解析过程-解释阶段</h1>
              <!--
                <p class="post-meta">Feb 28, 2019</p>
              -->
              <div class="meta">Posted on <span class="postdate">Feb 28, 2019</span> By <a target="_blank" href="http://localhost:4000">Kisn</a></div>
              <br />
            </header>
            <article class="post-content">
              <ul id="markdown-toc">
  <li><a href="#js引擎解析过程" id="markdown-toc-js引擎解析过程">JS引擎解析过程</a>    <ul>
      <li><a href="#什么是js引擎" id="markdown-toc-什么是js引擎">什么是JS引擎？</a></li>
      <li><a href="#js的解释阶段" id="markdown-toc-js的解释阶段">JS的解释阶段</a></li>
      <li><a href="#js的预处理阶段" id="markdown-toc-js的预处理阶段">JS的预处理阶段</a>        <ul>
          <li><a href="#分号补全" id="markdown-toc-分号补全">分号补全</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="js引擎解析过程">JS引擎解析过程</h2>
<h3 id="什么是js引擎">什么是JS引擎？</h3>
<blockquote>
  <p>JavaScript解析引擎是为「读懂」JavaScript代码，并准确地给出代码运行结果的一段程序。</p>
</blockquote>

<p>举个栗子：</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var a = 1 + 1;
</code></pre></div></div>
<p>JavaScript引擎所做的事情就是看懂（解析）这段代码，并将a的值变成2</p>

<h3 id="js的解释阶段">JS的解释阶段</h3>

<blockquote>
  <p>JS是解释型语言，所以它无需提前编译，而是由解释器实时运行的</p>
</blockquote>

<p>引擎对JS的处理过程：</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.读取代码，进行词法分析（Lexical analysis），然后讲代码分解成词元（token）
2.对词元进行语法分析（parsing），然后将代码整理成语法书（syntax tree）
3.使用翻译器（translator），将代码转为字节码（bytecode）
4.使用字节码解释器（bytecode interpreter），讲字节码转为机器码
</code></pre></div></div>
<p>最终计算机执行的就是机器码。
为了提高运行速度，浏览器一般采用即时翻译（JIT-JustIn Time compiler）</p>

<p>即字节码只在运行时编译，用到哪一行就编译哪一行，并且把编码结果缓存（iniline cache）</p>

<p>这样会使整个程序的运行速度提升
而且对于不同的浏览器可能策略不同，有的浏览器为了省略了字节码的翻译过程，直接转为机器码（比如chrome的v8）</p>

<p>总结：核心的JIT编译器可以将源码编译成机器码运行</p>

<h3 id="js的预处理阶段">JS的预处理阶段</h3>

<p>上述讲的解释器的整体过程，再讲一下在正式执行JS之前，还会有一个预处理阶段</p>

<ul>
  <li>变量提升</li>
  <li>分号补全</li>
  <li>处理变量冲突</li>
  <li>···</li>
</ul>

<h4 id="分号补全">分号补全</h4>

<p>这个比较简单</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>console.log('a')
console.log('b')
</code></pre></div></div>
<p>JS预处理会在后面加上分号，因为JS解释器有一个「Semicolon Insertion」规则，他会按照一定规则，在适当的位置补充分号</p>

<p>规则（不全）:</p>
<ul>
  <li>当有换行符的时候（包括含有换行符的多行注释），并且下一句token没有根前面的语法匹配时，自动添加分号。</li>
  <li>当有}时候，如果缺少分号，会添加分号</li>
  <li>程序源代码结束是，如果缺少分号，会补分号。</li>
</ul>

<p>最终</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>console.log('a');
console.log('b');
</code></pre></div></div>

<p>举一个反例</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function b() {
    return
    {
        a: 'a'
    };
}
</code></pre></div></div>
<p>可能你想输入的结果是：</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{a: 'a'}
</code></pre></div></div>
<p>但是由于分号补全机制，最后会变成：</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function b(){
    return;
    {
        a:'a'
    }
}
</code></pre></div></div>
<p>运行以后就是</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>undefined
</code></pre></div></div>

<p>变量提升</p>

<blockquote>
  <p>在执行过程中，可能开头没有定义变量或者函数，但是往往并没有报错。</p>
</blockquote>

<p>其中包括函数提升和变量提升</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a  = 1;
b();
function b(){
    console.log('b');
}

var a;
b();
</code></pre></div></div>

<p>由于变量提升，最终结果,2个b()都会执行，a会被赋值。</p>

            </article>
        </div>
      </div>
    </div>
  </div>
</div>

    
    <footer class="footer" role="contentinfo">
	<div class="container">
		<p class="copyright">Copyright &copy; 2014-2019 <a href="https://kisnnnnn.github.io/kisnStudy/"><code>Kisn</code></a>.</p>
		<!-- <p>Powered by <a href="http://jekyllrb.com">Jekyll</a>, themed from <a href="http://lesscss.cn/">Less</a>, refactored by <a href="http://www.hifreud.com/">Freud Kang</a></p> -->
	</div>
</footer>

<script src="/styles/js/jquery.min.js"></script>
<script src="/styles/js/bootstrap.min.js"></script>
<script src="/styles/js/holder.min.js"></script>
<script src="/styles/js/lessismore.js"></script>
<script src="/styles/js/application.js"></script>
<script src="/styles/js/jquery.zoom.min.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script>
	(function ($) {
		window.onload = function () {
			var imgELemList = $('.container img');

			imgELemList.on('click', function () {
				console.log(imgELemList);

				window.location.href = this.src;
			});
		}
	})(jQuery)
</script>

  </body>
</html>
