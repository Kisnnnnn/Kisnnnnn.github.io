<!DOCTYPE html>
<html>

  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>2019-05-29-VUE中的$ref、$on、$emit - 翻山越岭遇到一条狗的Blog</title>

	<link rel="shortcut icon" href="/styles/images/favicon.jpg">
	<link rel="icon" href="/styles/images/favicon.jpg">

	<link rel="stylesheet" href="/styles/css/index.css">
	<link rel="stylesheet" href="/styles/css/fontawesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="/styles/css/syntax.css">
	<link rel="canonical" href="/2019/05/29/VUE%E4%B8%AD%E7%9A%84ref-on-emit/">
	<link rel="alternate" type="application/rss+xml" title="翻山越岭遇到一条狗的Blog" href="/feed.xml">
	
	<meta name="keywords" content="2019-05-29-VUE中的$ref、$on、$emit, 翻山越岭遇到一条狗的Blog, 袁凯忻;个人博客;前端技术;">
	<meta name="description" content="袁凯忻;个人博客;前端技术;">

	<script src="/styles/js/jquery.min.js"></script>
	<!--[if lt IE 9]>
    	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  	<![endif]-->
  	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "//hm.baidu.com/hm.js?";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
  	<style type="text/css">
	  	.docs-content{
	  		margin-bottom: 10px;
	  	}
  	</style>
</head>

  <body class="index">

    <header class="navbar navbar-inverse navbar-fixed-top docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <!-- <a href="/" class="navbar-brand">
        <img src="/styles/images/logo.jpg">
      </a> -->
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        <li>
          <a href="/">Home</a>
        </li>
        <li>
          <a href="/categories/">Categories</a>
        </li>
        <li>
          <a href="/tag">Tag</a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <!-- <a><span id="busuanzi_container_site_pv" style="display:non">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></a> -->
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">关于<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a rel="nofollow" target="_blank" href="https://github.com/Kisnnnnn/">Github</a></li>
            <li><a rel="nofollow" target="_blank" href="https://kisnnnnn.github.io/kisnStudy/">关于作者</a></li>
            <li><a rel="nofollow" href="/books">我的书单</a></li>
            <li><a rel="nofollow" href="/reference">推荐博客</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</header>
    <div class="docs-header" id="content">
  <div class="container">
  	
  		<!--
		    <h1>2019-05-29-VUE中的$ref、$on、$emit</h1>
		    <p>Post on May 29, 2019 by <a href="/about">Kisn</a></p>
		-->
		    <h1>「今でもあなたはわたしの光」</h1>
    
  </div>
</div>
    
      
<div class="banner">
  <div class="container">
  	
    	<a href="/categories/#前端-ref">前端</a>	/
    	<a href="/tag/#笔记-ref">笔记</a>
    
  </div>
</div>

    

    <!-- <script src=""></script> -->
<link rel="stylesheet" href="/styles/css/index.css">
<link rel="stylesheet" href="/styles/css/fontawesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/styles/css/syntax.css">
<div class="container docs-container">
  <div class="row">
    <div class="col-md-3">
      <div class="sidebar hidden-print" role="complementary">
        <div id="navigation">
    <h1>目录</h1>
    <ul class="nav sidenav">
    </ul>
    <!-- <div style="height: 200px;width: 200px;">
      <script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33" async="async"> 
      </script>
    </div> -->
  </div>
  
   
      </div>
    </div>
    <div class="col-md-9" role="main">
      <div class="panel docs-content">
        <div class="wrapper">
            <header class="post-header">
              <h1 class="post-title">2019-05-29-VUE中的$ref、$on、$emit</h1>
              <!--
                <p class="post-meta">May 29, 2019</p>
              -->
              <div class="meta">Posted on <span class="postdate">May 29, 2019</span> By <a target="_blank" href="http://localhost:4000">Kisn</a></div>
              <br />
            </header>
            <article class="post-content">
              <ul id="markdown-toc">
  <li><a href="#emiteventnanmeargs" id="markdown-toc-emiteventnanmeargs">$emit(eventNanme,[…args])</a></li>
  <li><a href="#ref" id="markdown-toc-ref">ref</a></li>
  <li><a href="#ref-1" id="markdown-toc-ref-1">$ref</a>    <ul>
      <li><a href="#适用环境" id="markdown-toc-适用环境">适用环境：</a></li>
      <li><a href="#交互过程" id="markdown-toc-交互过程">交互过程</a></li>
    </ul>
  </li>
  <li><a href="#oneventcallback" id="markdown-toc-oneventcallback">$on(event,callback)</a>    <ul>
      <li><a href="#示例" id="markdown-toc-示例">示例</a>        <ul>
          <li><a href="#交互过程-1" id="markdown-toc-交互过程-1">交互过程：</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="emiteventnanmeargs">$emit(eventNanme,[…args])</h2>

<ul>
  <li>参数：
    <ul>
      <li>{string} eventName 触发事件名字</li>
      <li>[…args] 附加的参数</li>
    </ul>
  </li>
  <li>用法：
    <ul>
      <li>触发当前实例上的事件。附加参数都会传给监听器回调。</li>
    </ul>
  </li>
  <li>使用场景
    <ul>
      <li>子组件调用父组件的方法并且传递数据</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>注意：子组件标签中的时间也不区分大小写要用“-”隔开</p>
</blockquote>

<p>子组件：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;template&gt;
  &lt;button @click="emitEvent"&gt;点击我&lt;/button&gt;
&lt;/template&gt;
&lt;script&gt;
  export default {
    data() {
      return {
        msg: "我是子组件中的数据"
      }
    },
    methods: {
      emitEvent(){
        this.$emit('my-event', this.msg)
        //通过按钮的点击事件触发方法，然后用$emit触发一个my-event的自定义方法，传递this.msg数据。
      }
    }
  }
&lt;/script&gt;
</code></pre></div></div>

<p>父组件：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;template&gt;
  &lt;div id="app"&gt;
    &lt;child-a @my-event="getMyEvent"&gt;&lt;/child-a&gt;
    &lt;!--父组件中通过监测my-event事件执行一个方法，然后取到子组件中传递过来的值--&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
  import ChildA from './components/child.vue'
  export default {
    components: {
      ChildA
    },
    methods: {
      getMyEvent(msg){
          console.log('接收的数据---------&gt;'+msg)//接收的数据---------&gt;我是子组件中的数据
      }
    }
  }
&lt;/script&gt;
</code></pre></div></div>

<ul>
  <li>交互过程：
    <ul>
      <li>child.vue为子组件，当在child.vue，点击button。</li>
      <li>触发子组件的「emitEvent」方法</li>
      <li>在emitEvent方法中执行「this.$emit)(‘my-event’,this.msg)」,调用父组件的「my-event」的方法</li>
      <li>执行「getMyEvent」方法</li>
    </ul>
  </li>
</ul>

<p>实际上就是在子组件上操作，但是作用在父组件上。</p>

<h2 id="ref">ref</h2>
<blockquote>
  <p>被用来给元素或者子组件注册引用信息。引用信息将会被注册在父组件的$refs对象上。如果在普通的DOM元素上使用，引用指向的就是DOM元素；如果用在子组件上，引用就是指向组件实例：</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;!-- `vm.$refs.p` will be the DOM node --&gt;
&lt;!-- `vm.$refs.p` 指向这个DOM --&gt;
&lt;p ref="p"&gt;hello&lt;/p&gt;
&lt;!-- `vm.$refs.child` will be the child component instance --&gt;
&lt;!-- `vm.$refs.child` 指向这个子组件 --&gt;
&lt;child-com ref="chil"&lt;/child-com&gt;
</code></pre></div></div>

<p>ref 本身是作为渲染结果被创建的，在初始化渲染的时候你不能访问他们，因为他们还不存在，$refs也不是响应式的，因此你不应该试图用它在模板中做数据绑定。</p>

<h2 id="ref-1">$ref</h2>

<blockquote>
  <p>但是我们可以使用$ref在直接访问这个子组件。</p>
</blockquote>

<ul>
  <li>
    <h4 id="适用环境">适用环境：</h4>
    <ul>
      <li>父组件调用子组件的方法，可以传递数据。</li>
    </ul>
  </li>
</ul>

<p>父组件：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;template&gt;
  &lt;div id="app"&gt;
    &lt;child-a ref="child"&gt;&lt;/child-a&gt;
    &lt;!--用ref给子组件起个名字--&gt;
    &lt;button @click="getMyEvent"&gt;点击父组件&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
  import ChildA from './components/child.vue'
  export default {
    components: {
      ChildA
    },
    data() {
      return {
        msg: "我是父组件中的数据"
      }
    },
    methods: {
      getMyEvent(){
          this.$refs.child.emitEvent(this.msg);
          //调用子组件的方法，child是上边ref起的名字，emitEvent是子组件的方法。
      }
    }
  }
&lt;/script&gt;
</code></pre></div></div>

<p>子组件：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;template&gt;
  &lt;button&gt;点击我&lt;/button&gt;
&lt;/template&gt;
&lt;script&gt;
  export default {
    methods: {
      emitEvent(msg){
        console.log('接收的数据---------&gt;'+msg)//接收的数据---------&gt;我是父组件中的数据
      }
    }
  }
&lt;/script&gt;
</code></pre></div></div>
<ul>
  <li>
    <h4 id="交互过程">交互过程</h4>
    <ul>
      <li>绑定「child-a」组件，定义为「child」</li>
      <li>触发父组件的「getMyEvent」</li>
      <li>调用子组件的方法，child是上边ref起的名字，emitEvent是子组件的方法。</li>
      <li>子组件中「emitEvent」方法触发。</li>
    </ul>
  </li>
</ul>

<h2 id="oneventcallback">$on(event,callback)</h2>

<ul>
  <li>参数：
    <ul>
      <li>
        <table>
          <tbody>
            <tr>
              <td>{string</td>
              <td>Array<string>} event</string></td>
            </tr>
          </tbody>
        </table>
      </li>
      <li>{Funtion} callback</li>
    </ul>
  </li>
  <li>用法：
    <ul>
      <li>监听当前示例上的自定义事件。事件可以由vm.$emit触发。回调函数会接收所传入事件触发函数的额外参数</li>
    </ul>
  </li>
  <li>适用环境：
    <ul>
      <li>兄弟组件进行通信</li>
    </ul>
  </li>
</ul>

<h3 id="示例">示例</h3>

<ul>
  <li>
    <p>首先创建一个vue的空白实例（兄弟间的桥梁）</p>
  </li>
  <li>
    <p>父组件</p>
  </li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;template&gt;
     &lt;div&gt;
      &lt;childa&gt;&lt;/childa&gt;	
      &lt;br /&gt;
      &lt;childb&gt;&lt;/childb&gt;  	
     &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
   import childa from './childa.vue';
   import childb from './childb.vue';
   export default {
   	components:{
   		childa,
   		childb
   	},
   	data(){
   		return {
   			msg:""
   		}
   	},
   	methods:{
   		
   	}
   }
&lt;/script&gt;
</code></pre></div></div>
<ul>
  <li>子组件A  childa</li>
</ul>

<p>发送方使用 ==$emit== 自定义时间把数据带过去</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;template&gt;
    &lt;div&gt;
        &lt;span&gt;A组件-&gt;&lt;/span&gt;
        &lt;input type="button" value="把a组件数据传给b" @click ="send"&gt;
    &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;

// 空的组件(兄弟的桥梁)
import vmson from "../../../util/emptyVue"

export default {
    data(){
        return {
            msg:{
            	a:'111',
            	b:'222'
            }
        }
    },
    methods:{
        send:function(){
            vmson.$emit("aevent",this.msg)
        }
    }
}
&lt;/script&gt;
</code></pre></div></div>

<ul>
  <li>子组件 childb</li>
</ul>

<p>而接收方通过 ==$on==监听自定义时间的callback接收数据</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;template&gt;
 &lt;div&gt;
    &lt;span&gt;b组件,a传的的数据为-&gt;&lt;/span&gt;
 &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
	  import vmson from "../../../util/emptyVue"
	  export default {
		 data(){
		        return {
		            msg:""
		        }
		    },
		 mounted(){
		        vmson.$on("aevent",(val)=&gt;{
		            //监听事件aevent，回调函数要使用箭头函数;
		            console.log(val);//打印结果：我是a组件的数据
		            this.msg = val;
		        })
		  }
	}
&lt;/script&gt;
</code></pre></div></div>

<h4 id="交互过程-1">交互过程：</h4>
<ul>
  <li>定义一个父组件，作为A/B子组件的通信桥梁</li>
  <li>在A组件来中设定一个自定义事件「aevent」</li>
  <li>在B组件中，通过父组件「vmson」进行监听「aevent」事件的触发，进行回调</li>
</ul>

<p>当然还有其他API</p>

<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1g3j3ej34uaj30jm0jlaah.jpg" alt="image" /></p>

            </article>
        </div>
      </div>
    </div>
  </div>
</div>

    
    <footer class="footer" role="contentinfo">
	<div class="container">
		<p class="copyright">Copyright &copy; 2014-2019 <a href="https://kisnnnnn.github.io/kisnStudy/"><code>Kisn</code></a>.</p>
		<!-- <p>Powered by <a href="http://jekyllrb.com">Jekyll</a>, themed from <a href="http://lesscss.cn/">Less</a>, refactored by <a href="http://www.hifreud.com/">Freud Kang</a></p> -->
	</div>
</footer>

<script src="/styles/js/jquery.min.js"></script>
<script src="/styles/js/bootstrap.min.js"></script>
<script src="/styles/js/holder.min.js"></script>
<script src="/styles/js/lessismore.js"></script>
<script src="/styles/js/application.js"></script>
<script src="/styles/js/jquery.zoom.min.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script>
	(function ($) {
		window.onload = function () {
			var imgELemList = $('.container img');

			imgELemList.on('click', function () {
				console.log(imgELemList);

				window.location.href = this.src;
			});
		}
	})(jQuery)
</script>

  </body>
</html>
